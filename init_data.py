import numpy as np
from utils import generate_key
from datetime import datetime
from manager import (
    PersonsDatabase, FacesDatabase
)

data = [
    {
        'name': 'Azamat',
        'surname': 'Bakhytzhan',
        'faces': [np.array([-0.06380197,  0.01336958,  0.05115691, -0.06474592, -0.07742794,
       -0.03001853, -0.00545971, -0.13110298,  0.10424973, -0.10557967,
        0.31011194, -0.07280684, -0.20485592, -0.13062896, -0.06654622,
        0.17157733, -0.12495179, -0.08557099, -0.04681403, -0.01069754,
        0.13522336, -0.03974984, -0.03306622,  0.03725953, -0.04500829,
       -0.29386497, -0.08248547, -0.02313236,  0.08347754, -0.06218584,
       -0.03465112, -0.00070813, -0.20508778, -0.06205177,  0.01502755,
        0.06753294, -0.04696496, -0.0960792 ,  0.16402529, -0.0470406 ,
       -0.22261514,  0.02557246,  0.05321087,  0.18400685,  0.18547431,
        0.03208204, -0.00772108, -0.13260946,  0.08109637, -0.21300955,
        0.01841695,  0.13076034,  0.13229069,  0.04499896, -0.03807838,
       -0.11388677,  0.00664803,  0.126766  , -0.19920291,  0.02150344,
        0.09312695, -0.08099341, -0.05215157, -0.07897811,  0.15304884,
        0.07260828, -0.16130881, -0.15022795,  0.13675818, -0.15738691,
       -0.01115712,  0.06181737, -0.12266915, -0.2307803 , -0.24235527,
        0.05699271,  0.41986406,  0.13460675, -0.19528487,  0.00209309,
       -0.07283433,  0.03439013,  0.16445559,  0.08224633,  0.0532125 ,
       -0.0403396 , -0.0845098 ,  0.01927339,  0.16165587, -0.0981864 ,
       -0.00443558,  0.24060667, -0.00714456,  0.05258415, -0.02388459,
        0.07526615, -0.02794268,  0.0970155 , -0.09920252,  0.03131218,
        0.0300557 , -0.03450284,  0.07045231,  0.07393518, -0.1144715 ,
        0.13806805,  0.01835774,  0.04839457,  0.08224981, -0.04731171,
       -0.09999124, -0.07012719,  0.10154521, -0.23277701,  0.21423364,
        0.1852926 ,  0.07124816,  0.1103453 ,  0.12691891,  0.09545355,
        0.0670062 , -0.09718405, -0.1970818 , -0.01213568,  0.04194413,
       -0.05151638,  0.0681681 , -0.03154546]),
       np.array([-0.05806601,  0.05147488, -0.00931048, -0.02069305, -0.04426552,
        0.02208392, -0.00766712, -0.14410888,  0.19934922, -0.13056591,
        0.23489338, -0.06968719, -0.23453061, -0.12076997, -0.04315656,
        0.17590654, -0.12661049, -0.10448159, -0.03741523, -0.0093848 ,
        0.08729456,  0.00763475,  0.01031971,  0.0448352 , -0.10645498,
       -0.35964477, -0.11570442, -0.06029174,  0.03229714, -0.06075534,
       -0.09252433,  0.02771871, -0.15137979, -0.06543954,  0.05781472,
        0.03419887, -0.00430025, -0.02748248,  0.16040151,  0.00361658,
       -0.23908761,  0.02055649,  0.05084259,  0.24873671,  0.17479062,
        0.07257529, -0.02477451, -0.16007923,  0.11915123, -0.15232298,
        0.05834938,  0.10659069,  0.09099706,  0.03821485,  0.01837609,
       -0.13830632, -0.02838424,  0.11043252, -0.16187225, -0.00688495,
        0.07556287, -0.05214198, -0.02798296, -0.04367425,  0.17771825,
        0.05636892, -0.14227426, -0.15130416,  0.12464914, -0.15404455,
       -0.00215312,  0.02864991, -0.14141971, -0.22068727, -0.30562034,
        0.05212787,  0.47346711,  0.1477745 , -0.17191328,  0.03683564,
       -0.05025844,  0.03313693,  0.18243444,  0.1244572 , -0.01826848,
       -0.00079263, -0.0500705 ,  0.00699782,  0.15971234, -0.05393771,
       -0.05753206,  0.20200214, -0.03205916,  0.09661192,  0.01162372,
        0.04892446, -0.07492174,  0.05936784, -0.13485461, -0.01149346,
        0.01463353, -0.00378702,  0.08008318,  0.12226085, -0.15904135,
        0.14667791,  0.05253032,  0.02490245,  0.0747448 ,  0.06177796,
       -0.10587548, -0.080835  ,  0.07810656, -0.28147438,  0.17082673,
        0.15265331,  0.08263268,  0.15049241,  0.09658341,  0.08624546,
        0.03394255, -0.01679912, -0.18509068, -0.01626917,  0.09690015,
       -0.01231677,  0.10738206, -0.02170994])
        ],
    },
]


with PersonsDatabase() as manager:
    for person in data:
        key = generate_key(person['name'], person['surname'])
        manager.create(key, {
            'name': person['name'],
            'surname': person['surname'],
        })

with FacesDatabase() as manager:
    for person in data:
        key = generate_key(person['name'], person['surname'])
        counter = 0
        for face in person['faces']:
            counter += 1
            manager.create(key + str(counter), {
                'person_id': key,
                'encoding': face,
                'updated': datetime.now()
            })